(function(a){if(typeof define=='function'&&define.amd)define(['jquery'],a);else if(typeof module=='object'&&module.exports){var b=require('jquery');a(b),module.exports=b}else a(jQuery)})(function(a){function b(a){this.init(a)}b.prototype={value:0,size:100,startAngle:-Math.PI,thickness:'auto',fill:{gradient:['#3aeabb','#fdd250']},emptyFill:'rgba(0, 0, 0, .1)',animation:{duration:1200,easing:'circleProgressEasing'},animationStartValue:0,reverse:!1,lineCap:'butt',insertMode:'prepend',constructor:b,el:null,canvas:null,ctx:null,radius:0,arcFill:null,lastFrameValue:0,init:function(b){a.extend(this,b),this.radius=this.size/2,this.initWidget(),this.initFill(),this.draw(),this.el.trigger('circle-inited')},initWidget:function(){var b,c;this.canvas||(this.canvas=a('<canvas>')[this.insertMode=='prepend'?'prependTo':'appendTo'](this.el)[0]),b=this.canvas,b.width=this.size,b.height=this.size,this.ctx=b.getContext('2d'),window.devicePixelRatio>1&&(c=window.devicePixelRatio,b.style.width=b.style.height=this.size+'px',b.width=b.height=this.size*c,this.ctx.scale(c,c))},initFill:function(){var c=this,b=this.fill,m=this.ctx,e=this.size,f,h,n,k,i,g,l,d;if(!b)throw Error("The fill is not specified!");if(typeof b=='string'&&(b={color:b}),b.color&&(this.arcFill=b.color),b.gradient)if(f=b.gradient,f.length==1)this.arcFill=f[0];else if(f.length>1){h=b.gradientAngle||0,n=b.gradientDirection||[e/2*(1-Math.cos(h)),e/2*(1+Math.sin(h)),e/2*(1+Math.cos(h)),e/2*(1-Math.sin(h))],k=m.createLinearGradient.apply(m,n);for(i=0;i<f.length;i++)g=f[i],l=i/(f.length-1),a.isArray(g)&&(l=g[1],g=g[0]),k.addColorStop(l,g);this.arcFill=k}b.image&&(b.image instanceof Image?d=b.image:(d=new Image,d.src=b.image),d.complete?j():d.onload=j);function j(){var b=a('<canvas>')[0];b.width=c.size,b.height=c.size,b.getContext('2d').drawImage(d,0,0,e,e),c.arcFill=c.ctx.createPattern(b,'no-repeat'),c.drawFrame(c.lastFrameValue)}},draw:function(){this.animation?this.drawAnimated(this.value):this.drawFrame(this.value)},drawFrame:function(a){this.lastFrameValue=a,this.ctx.clearRect(0,0,this.size,this.size),this.drawEmptyArc(a),this.drawArc(a)},drawArc:function(d){if(d===0)return;var a=this.ctx,b=this.radius,e=this.getThickness(),c=this.startAngle;a.save(),a.beginPath(),this.reverse?a.arc(b,b,b-e/2,c-Math.PI*2*d,c):a.arc(b,b,b-e/2,c,c+Math.PI*2*d),a.lineWidth=e,a.lineCap=this.lineCap,a.strokeStyle=this.arcFill,a.stroke(),a.restore()},drawEmptyArc:function(c){var a=this.ctx,b=this.radius,d=this.getThickness(),e=this.startAngle;c<1&&(a.save(),a.beginPath(),c<=0?a.arc(b,b,b-d/2,0,Math.PI*2):this.reverse?a.arc(b,b,b-d/2,e,e-Math.PI*2*c):a.arc(b,b,b-d/2,e+Math.PI*2*c,e),a.lineWidth=d,a.strokeStyle=this.emptyFill,a.stroke(),a.restore())},drawAnimated:function(e){var c=this,b=this.el,d=a(this.canvas);d.stop(!0,!1),b.trigger('circle-animation-start'),d.css({animationProgress:0}).animate({animationProgress:1},a.extend({},this.animation,{step:function(a){var d=c.animationStartValue*(1-a)+e*a;c.drawFrame(d),b.trigger('circle-animation-progress',[a,d])}})).promise().always(function(){b.trigger('circle-animation-end')})},getThickness:function(){return a.isNumeric(this.thickness)?this.thickness:this.size/14},getValue:function(){return this.value},setValue:function(a){this.animation&&(this.animationStartValue=this.lastFrameValue),this.value=a,this.draw()}},a.circleProgress={defaults:b.prototype},a.easing.circleProgressEasing=function(a){return a<.5?(a=2*a,.5*a*a*a):(a=2-2*a,1-.5*a*a*a)},a.fn.circleProgress=function(c,f){var d='circle-progress',e=this.data(d),g;if(c=='widget'){if(!e)throw Error('Calling "widget" method on not initialized instance is forbidden');return e.canvas}if(c=='value'){if(!e)throw Error('Calling "value" method on not initialized instance is forbidden');return typeof f=='undefined'?e.getValue():(g=arguments[1],this.each(function(){a(this).data(d).setValue(g)}))}return this.each(function(){var g=a(this),h=g.data(d),f=a.isPlainObject(c)?c:{},e;h?h.init(f):(e=a.extend({},g.data()),typeof e.fill=='string'&&(e.fill=JSON.parse(e.fill)),typeof e.animation=='string'&&(e.animation=JSON.parse(e.animation)),f=a.extend(e,f),f.el=g,h=new b(f),g.data(d,h))})}})
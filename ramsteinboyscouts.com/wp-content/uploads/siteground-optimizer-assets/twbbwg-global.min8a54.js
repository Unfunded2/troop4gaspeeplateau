jQuery(function(){if(jQuery(".bwg-container").length){var a='<div class="twb_admin_bar_menu_header">';a+='<img class="twb_menu_logo" src="'+twb.plugin_url+'/assets/images/logo_white.svg" />',a+='<div class="twb_menu_logo">Optimize Images</div>',a+='</div>',jQuery(".twb_admin_bar_menu").html(a).on("click",function(){window.open(twb.href,'_blank')}),jQuery(".twb_admin_bar_menu_main").remove()}twb_inprogress=!1,jQuery(".twb-notoptimized").each(function(){jQuery(this).data("status")=='inprogress'&&twb_disable_check()}),jQuery(".twb-notoptimized .twb_check_score_button").on("click",function(){twb_inprogress||twb_check_score(this)}),jQuery("th[id^='twb-speed-']").hover(function(){jQuery(this).find(".twb-dismiss-container").removeClass("twb-hidden")},function(){jQuery(this).find(".twb-dismiss-container").addClass("twb-hidden")}),jQuery(".twb-see-score").hover(function(){jQuery(this).parent().parent().find(".twb-score-container").removeClass("twb-hidden")},function(){jQuery(this).parent().parent().find(".twb-score-container").addClass("twb-hidden")}),jQuery(".twb-score-container:not(.twb_admin_bar_menu_content .twb-score-container), .twb-score-disabled-container").hover(function(){jQuery(this).removeClass("twb-hidden")},function(){jQuery(this).addClass("twb-hidden")}),jQuery(".twb-score-circle").each(function(){twb_draw_score_circle(this)}),jQuery("#wp-admin-bar-twb_adminbar_info").mouseenter(function(){jQuery(".twb_admin_bar_menu_main .twb-score-container").removeClass("twb-hidden"),jQuery(".twb_admin_bar_menu_main").removeClass("twb-hidden")}).mouseleave(function(){jQuery(".twb_admin_bar_menu_main").addClass("twb-hidden")}),jQuery('.twb-score-circle').each(function(){twb_draw_score_circle(this)}),jQuery(".twb_admin_bar_menu.twb_backend span").hasClass("twb_backend_optimizing_logo")&&(twb_run_notif_check=setInterval(twb_run_notif_check,3e4))});function twb_run_notif_check(){jQuery.ajax({type:"POST",url:twb.ajax_url,data:{action:"twb_notif_check",twb_nonce:twb.nonce}}).success(function(b){var a=jQuery.parseJSON(b);a.html!=""&&(a.changeLogo==1&&jQuery(".twb_admin_bar_menu_header span").addClass("twb_counted"),jQuery("#wp-admin-bar-twb_adminbar_info").append(a.html),jQuery(".twb_admin_bar_menu_content .twb-score-container").removeClass("twb-hidden"),jQuery(".twb_admin_bar_menu_content .twb-score-container .twb-score-circle").each(function(){twb_draw_score_circle(this)}),clearInterval(twb_run_notif_check))}).error(function(){clearInterval(twb_run_notif_check)})}function twb_disable_check(){twb_inprogress=!0,jQuery(".twb-notoptimized").hover(function(){jQuery(this).parent().find(".twb-score-disabled-container").removeClass("twb-hidden")},function(){jQuery(this).parent().find(".twb-score-disabled-container").addClass("twb-hidden")})}function twb_check_score(b){var c=jQuery(b).data("post_id"),a=jQuery(b).parent().parent().parent();jQuery(".twb_admin_bar_menu.twb_frontend").addClass("twb_score_inprogress"),a.find(".twb-optimized").hasClass("twb-hidden")?a.find(".twb-optimizing").removeClass("twb-hidden"):(a.find(".twb-score-overlay").removeClass("twb-hidden"),a.find(".twb-score-overlay div").removeClass("twb-reload").addClass("twb-loader")),a.find(".twb-notoptimized").addClass("twb-hidden"),a.hasClass("twb_elementor_settings_content")&&jQuery(".twb_elementor_control_title").text(twb.checking).removeClass("twb_not_optimized").prepend("<span class='twb_inprogress'></span>"),twb_disable_check(),jQuery.ajax({url:twb.ajax_url,type:"POST",dataType:'json',data:{action:"twb_check_score",post_id:c,twb_nonce:twb.nonce},success:function(b){var c,d;b.error?(a.find(".twb-score-overlay").removeClass("twb-hidden"),a.find(".twb-score-overlay div").removeClass("twb-loader").addClass("twb-reload")):(a.find(".twb-score-overlay").addClass("twb-hidden"),c=a.find(".twb-score-desktop").find(".twb-score-circle"),c.data({score:b.desktop_score,tti:b.desktop_tti}),twb_draw_score_circle(c),d=a.find(".twb-score-mobile").find(".twb-score-circle"),d.data({score:b.mobile_score,tti:b.mobile_tti}),twb_draw_score_circle(d))},error:function(b,c,d){a.find(".twb-score-overlay").removeClass("twb-hidden"),a.find(".twb-score-overlay div").removeClass("twb-loader").addClass("twb-reload")},complete:function(b,c){a.find(".twb-optimizing").addClass("twb-hidden"),a.find(".twb-optimized").removeClass("twb-hidden"),jQuery("#wpadminbar .twb-optimized .twb-score-container").removeClass("twb-hidden"),jQuery("#wpadminbar .twb_admin_bar_menu").removeClass("twb_score_inprogress"),jQuery("#wpadminbar .twb_menu_logo").remove(),jQuery("#wpadminbar .twb_not_optimized_logo").removeClass("twb-hidden"),jQuery("#wpadminbar .twb_admin_bar_menu_header").addClass("twb_not_optimized"),twb_inprogress=!1,jQuery(".twb-notoptimized").hover(function(){jQuery(this).parent().find(".twb-score-disabled-container").addClass("twb-hidden")}),a.hasClass("twb_elementor_settings_content")&&jQuery(".twb_elementor_control_title").text(twb.notoptimized).remove("span.twb_inprogress").addClass("twb_not_optimized")}})}function twb_draw_score_circle(a){var b=parseInt(jQuery(a).data('score')),e=parseInt(jQuery(a).data('size')),f=parseInt(jQuery(a).data('thickness')),c=b<=49?"rgb(253, 60, 49)":b>=90?"rgb(12, 206, 107)":"rgb(255, 164, 0)",d;if(jQuery(a).parent().find('.twb-load-time').html(jQuery(a).data('tti')),d=a,typeof jQuery(d).circleProgress!='function')return;jQuery(d).circleProgress({value:b/100,size:e,startAngle:-Math.PI/4*2,lineCap:'round',emptyFill:"rgba(255, 255, 255, 0)",thickness:f,fill:{color:c}}).on('circle-animation-progress',function(f,d){var e='<span class="twb-score0"></span>';b!=0&&(e=Math.round(b*d)),jQuery(a).find('.twb-score-circle-animated').html(e).css({color:c}),jQuery(a).find('canvas').html(Math.round(b*d))})}function twb_add_elementor_button(){window.elementor.modules.layouts.panel.pages.menu.Menu.addItem({name:twb.title,icon:"twb-element-menu-icon",title:twb.title,type:"page",callback:()=>{try{window.$e.route("panel/page-settings/twb_optimize")}catch(a){window.$e.route("panel/page-settings/settings"),window.$e.route("panel/page-settings/twb_optimize")}}},"more")}jQuery(window).on("elementor:init",()=>{window.elementor.on("panel:init",()=>{setTimeout(twb_add_elementor_button)})})